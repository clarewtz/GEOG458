---
title: "Howmework 1, STAT 504"
author: "Tianzhe Wang, 1568476"
date: "January 14, 2017"
output: html_document
---


# Problem 1

### 1.1

According to the description, outcome variable could be teacher's pay, and explanatory variable could be spending on public schools per pupil.

```{r setup, include=TRUE}
setwd("/Users/apple/Desktop/2017WINTER/STAT504/homework")
pay<-read.table("teacherpay.dat", header=TRUE)
plot(pay$SPEND, pay$PAY, main="Scatterplot of Teacher Pay", xlab="spending per pupil", ylab="teacher pay", pch = 20, ylim = c(15000, 45000), xlim = c(2000, 9000))
```

This scatter plot shows that points appear to be fitted by a line, despite of some dispersion. It could also be seen that variances might be about the same, since variabilities look stable - not increase or decrease as X changes. Therefore it makes sense to use a simple linear regression model for this dataset.

### 1.2
xbar, ybar, SXX, SYY, and SXY; slope and intercept

```{r}
xbar<-mean(pay$SPEND)
xbar 

ybar<-mean(pay$PAY)
ybar

sxx = 0
for (i in 1:length(pay$SPEND)) {
  sxx = sxx + (pay$SPEND[i] - xbar)^2
}
sxx

syy = 0
for (i in 1:length(pay$PAY)) {
  syy = syy + (pay$PAY[i] - ybar)^2
}
syy

sxy = 0
for (i in 1:length(pay$SPEND)) {
  sxy = sxy + (pay[i,2] - xbar)*(pay[i,1] - ybar)
}
sxy

# slope
b1 = sxy/sxx
b1
# intercept
b0 = ybar - b1*xbar
b0

# Add fitted line
plot(pay$SPEND, pay$PAY, main="Scatterplot of Teacher Pay", xlab="spending per pupil", ylab="teacher pay", pch = 20, ylim = c(15000, 45000), xlim = c(2000, 9000))
abline(lm(pay$PAY~pay$SPEND), col="red")
```

### 1.3 
Residual Variance
```{r}
rss = syy - (sxy^2)/sxx
df = length(pay$PAY)-2
rv = rss/df
rv
```

Residual variance is quite large, which is to say linear regression doesn't fit the data so well. It could be due to average spending on pupils might not be sufficient to explain teachers' pay. 

### 1.4
```{r}
seb1 = sqrt(rv)/sqrt(sxx)
seb1
t = 2.01
lower = b1 - t*seb1
upper = b1 + t*seb1
ci = c(lower, upper)
ci
```
The 95% confidence interval of estimated coefficient is 2.681 and 3.93, which means there is 0.95 probability that the true coefficient falls between 2.681 and 3.93.


# Problem 2
```{r}
plot(faithful$waiting, faithful$eruptions, main="Scatterplot of Eruptions", xlab="waiting time", ylab="eruption duration", pch = 20)
```

Based on the scatterplot, a simple regression won't fit this data well. Eruption durations (Y) are evidently clustered at certain values of waiting time (X). The fitted lines for these two clusters seem to have different slopes or intercepts. 

The variabilities of eruption durations also don't seem to remain constant along the waiting time. As waiting time increases, variability of eruption time also increases. It violates the assumption of homoscedasticity of simple linear regression.

```{r}


```

This summation expression $\sum_{i=1}^n X_i$ appears inline.


